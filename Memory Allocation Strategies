#include <stdio.h>
#include <stdlib.h>

/* ---------- MEMORY ALLOCATION ---------- */
void memory_allocation() {
    int nb, nf, i, j;
    int block[10], file[10], alloc[10];
    int choice;

    printf("\nEnter number of memory blocks: ");
    scanf("%d", &nb);
    printf("Enter block sizes:\n");
    for(i = 0; i < nb; i++) scanf("%d", &block[i]);

    printf("Enter number of files: ");
    scanf("%d", &nf);
    printf("Enter file sizes:\n");
    for(i = 0; i < nf; i++) scanf("%d", &file[i]);

    for(i = 0; i < nf; i++) alloc[i] = -1;

    printf("\n1.First Fit  2.Best Fit  3.Worst Fit\nChoose: ");
    scanf("%d", &choice);

    for(i = 0; i < nf; i++) {
        int idx = -1;
        for(j = 0; j < nb; j++) {
            if(block[j] >= file[i]) {
                if(idx == -1 ||
                   (choice == 2 && block[j] < block[idx]) ||
                   (choice == 3 && block[j] > block[idx]))
                    idx = j;
                if(choice == 1) break;
            }
        }
        if(idx != -1) {
            alloc[i] = idx;
            block[idx] -= file[i];
        }
    }

    printf("\nFile\tBlock\n");
    for(i = 0; i < nf; i++)
        printf("%d\t%s\n", i+1,
               alloc[i] != -1 ? "Allocated" : "Not Allocated");
}

/* ---------- RANDOM ACCESS FILE ---------- */
struct emp {
    int id;
    char name[20];
    float salary;
};

void random_access_file() {
    FILE *fp;
    struct emp e;
    int n, i, rec;

    fp = fopen("emp.dat", "wb+");

    printf("\nEnter number of employees: ");
    scanf("%d", &n);

    for(i = 0; i < n; i++) {
        printf("Enter ID Name Salary: ");
        scanf("%d %s %f", &e.id, e.name, &e.salary);
        fwrite(&e, sizeof(e), 1, fp);
    }

    printf("\nEnter record number to read: ");
    scanf("%d", &rec);

    fseek(fp, (rec - 1) * sizeof(e), SEEK_SET);
    fread(&e, sizeof(e), 1, fp);

    printf("\nEmployee Details\nID:%d Name:%s Salary:%.2f\n",
           e.id, e.name, e.salary);

    fclose(fp);
}

/* ---------- MAIN ---------- */
int main() {
    int ch;

    printf("\n1.Memory Allocation\n2.Random Access File\nChoose option: ");
    scanf("%d", &ch);

    if(ch == 1)
        memory_allocation();
    else if(ch == 2)
        random_access_file();
    else
        printf("Invalid choice");

    return 0;
}
